{"componentChunkName":"component---src-templates-post-template-post-template-tsx","path":"/posts/next-js-static-exports-with-i18n","result":{"data":{"markdownRemark":{"id":"ed05ea97-a11e-5c43-8f3f-77fddea5932a","html":"<h2 id=\"0-배경\" style=\"position:relative;\"><a href=\"#0-%EB%B0%B0%EA%B2%BD\" aria-label=\"0 배경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>0. 배경</h2>\n<p>현업에서 서버가 필요하지 않은 페이지의 경우, 서버 관리와 비용을 최소화하기 위해\n<code class=\"language-text\">Next.js의 Static Exports</code> 를 이용하여 <code class=\"language-text\">S3</code>를 이용한 <strong>정적 페이지 배포 방식을 채택하였다.</strong></p>\n<p>하지만, <code class=\"language-text\">next-i18next</code>를 이용한 국제화 라우팅은 Node.js 서버를 통해 처리된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 639px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/698740b4e6b5fad478b74aa95b5fc1dc/738b8/image.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.25000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABoElEQVQ4y52S647bIBCFB7Bj4wv4AgwDdhInm21tJ1tV6vs/W+W06r9ksz0aIY3EpzM6MxBjXJZlnudlWW632+Vymed5XVfnHAAwxuCJCim1Ul3XKqW0UrKQWmutVJZlf2D+QBusmiaMo0HvKPg4GIc0jEjkvUfEGCMi0r11zoUQrLVEFGNMkgSoUd8jvmF/dv3Fm3dvzqa9xO03EZVl+WzsdQck1VjboeoHhUNtY+1+7lgCLyiknDRSOwSFlOWUS8rlPmWcsU/SuovDTkPeQyLhq9oc6oHpExMZA/hXr4kxkAZKD2L3Zec73G8wE//BcqhH0BMUuPFbUn/r8wvbnDO9TS4NFA6kgyJCjpCUr5kXhlXESg9VzBRa6xDJ38/qx8eHUgoeRbiNV3ioj9sLgos0ETwRPE2E4LyQUiSP74UBqI46P3V4aC3xXZVXXWuD7rDtUSRPV8AAbHyL05Wma5hWLk3rpsO3X+Pptj+tJpxVYx7GxhiYcA7TzR9XOl4reyy0VR2pFlVrG7tvev8YBtA9GX/ocez90dKUpumLe/4Nedoh4RF4qSsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/698740b4e6b5fad478b74aa95b5fc1dc/8ac56/image.webp 240w,\n/static/698740b4e6b5fad478b74aa95b5fc1dc/d3be9/image.webp 480w,\n/static/698740b4e6b5fad478b74aa95b5fc1dc/d95e5/image.webp 639w\"\n              sizes=\"(max-width: 639px) 100vw, 639px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/698740b4e6b5fad478b74aa95b5fc1dc/8ff5a/image.png 240w,\n/static/698740b4e6b5fad478b74aa95b5fc1dc/e85cb/image.png 480w,\n/static/698740b4e6b5fad478b74aa95b5fc1dc/738b8/image.png 639w\"\n            sizes=\"(max-width: 639px) 100vw, 639px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/698740b4e6b5fad478b74aa95b5fc1dc/738b8/image.png\"\n            alt=\"image\"\n            title=\"image\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span><em>정적 파일 배포 시 지원하지 않는 기능 “국제화 라우팅”</em></p>\n<blockquote>\n<p>즉, 정적 배포 시에는 국제화 라우팅 기능을 사용할 수가 없다.\n그러면.. 국제화는 어떻게 진행하지?</p>\n</blockquote>\n<br />\n<br />\n<h2 id=\"1-국제화-라우팅-직접-구현\" style=\"position:relative;\"><a href=\"#1-%EA%B5%AD%EC%A0%9C%ED%99%94-%EB%9D%BC%EC%9A%B0%ED%8C%85-%EC%A7%81%EC%A0%91-%EA%B5%AC%ED%98%84\" aria-label=\"1 국제화 라우팅 직접 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 국제화 라우팅 직접 구현</h2>\n<p>불행 중 다행히도, <a href=\"https://github.com/i18next/next-i18next?tab=readme-ov-file#static-html-export-ssg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">next-i18n-next 에서는 이 블로그를 참고하여 직접 구현하는 것을 제안한다.</a></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 864px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8d19eb0a85a14bce0f0708f922083d5e/9cab2/image-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.74999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAACuElEQVQozyWRSW+baACGUVNDWAx8gMGAweZjNzvGJrYJXurEteVmbaN0cTepM0oXtVUP1aiHOY3mb1dtpffwPIfn9CJRXg7KuijrtJiMJnPTjSlGooHMcG2Wl1leBoICBOUP/1GWl2kg0UBCetCz3dB2Iz9MbS+SYSYamWQWXSd1/MQN8qSYxoOJ7SduP/WC3HQjVbea7O8YSF0ZpqqVK2YqGYnqDFUraamGqBiS0msrXVk12mpPVH5N1iADWhTNU4xAAxHpWoEVTXpuYfqlHU0tr4Qw7uq2YTiCYgHZ5RSflT2pY/eg01Jt0OmLmqf0fIbXEMUttWQpp/OWG7egx+cDoaoEPxLdiIUxMDLByHg9anU8WXeEjsvrkaD1W5rHiD2E1QIqmKHVprHYoNm8cfvs4L/v98939yZzdLQg/DHjlLyZAz1mOyGj9jktYBSf7QSs4iJ8x2fco8PqBNueHw6XeL1ufPkL/XuPzlfoaIZ7I9o5AjBve2MBZm0zZzuhbBecHgPVQziYMFaBBfnh5gIr6kMnxy6v0I9v0OsztBij8RGm+02ruHj7+dH+7snrD8tHT29e3rn5oilZCNBD1hriRkJOTolygQdDvDrB3r5EL9fY1Rn2YNPoD5rDBzdfftz9+H//6Z/33/7dv/u6uX5FihbC6wHfjWgzJ8MpGU/ItMKLJZZU6GqF7R9jr26xaoou1872Aq6v/PNner0b7J7CYgX0EOG0Pg8z4IyYfE2ZBWlklF1QRkbkK2K2JZ+/wNc74vj0fnR0UJ8eHK8ag/ogHFP+GMAU4VSvZRWiMxKiORvWTHDMhjPOHbP9WbO/wKMlPt6R0YIOanKypc5umO01mD4E2YJ3CgS0LV4PhW4o9CIeppyRMs6QsQbASJr2kIQ54ZVE/uszwh4S5YI8PmmmFe2PODP5CdVzeyfW+c/5AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8d19eb0a85a14bce0f0708f922083d5e/8ac56/image-1.webp 240w,\n/static/8d19eb0a85a14bce0f0708f922083d5e/d3be9/image-1.webp 480w,\n/static/8d19eb0a85a14bce0f0708f922083d5e/b4e26/image-1.webp 864w\"\n              sizes=\"(max-width: 864px) 100vw, 864px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8d19eb0a85a14bce0f0708f922083d5e/8ff5a/image-1.png 240w,\n/static/8d19eb0a85a14bce0f0708f922083d5e/e85cb/image-1.png 480w,\n/static/8d19eb0a85a14bce0f0708f922083d5e/9cab2/image-1.png 864w\"\n            sizes=\"(max-width: 864px) 100vw, 864px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8d19eb0a85a14bce0f0708f922083d5e/9cab2/image-1.png\"\n            alt=\"image 1\"\n            title=\"image 1\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span><em>아.. 지원 안하니까 포스팅 보고 직접 해라.. ㅇㅋ</em></p>\n<p>친절한 포스팅 덕분에 다음과 같은 순서를 거쳐 작업을 진행했다.</p>\n<ol>\n<li><code class=\"language-text\">next-i18next</code>, <code class=\"language-text\">next-language-detector</code> 설치</li>\n<li><code class=\"language-text\">/[locale]</code> 하위로 모든 pages 이동</li>\n<li>추출한 언어 JSON <code class=\"language-text\">public/locales/</code> 하위로 <code class=\"language-text\">ko</code>, <code class=\"language-text\">en</code> 추가</li>\n<li>동적 라우트를 위한 js 추가 샘플 코드</li>\n<li>app, document 세팅</li>\n<li>redirect 로직 추가</li>\n</ol>\n<p>예시 코드는 모두 <code class=\"language-text\">js</code> 로 되어있었기 때문에 <code class=\"language-text\">@ts-ignore</code> , <code class=\"language-text\">eslint-disabled</code> 처리하고 기능 동작 자체에만 집중하여 마무리했다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/47aa2c81e19f0c82d54ce10edfd55729/302a4/image-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.166666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACvElEQVQoz3XTyU8TURwH8FdqZFFiNLgQOnnhYFJuEMUr0QT/A+AfgOjRE/FgolGJRA8aNfEEAYOeOCgHlUVaCkNby1q2QoW2ttOFLrSdTpfZvuYRIBD0m7zDezPvkze/9xtCjiUcjJZFQjESC8fvzLsWYZ20wb20mlxfXmmxjP1osttsN3mr9YbdZrs1OTpas+xyEffcHHnY3U1OhVJKoqGY4Y8vRAK+oNm7sZXxbniRjCYAVQWKMvRCASgWoeXzEHy+5wAIAOOnwcHTGBvDn4f250JIJ7lkeg35LcT9X9Xozhc9n7DrqpTTpVRKhqIgLggvDsCyj/39pzE22AtPH78k9fV1l5dcC9vpyAwW+dfasv2tHg+M6Fo+pyeEsBwXQgh4vT1aPk92PB5jU2PjkXECZOE47lJVVcXFXDK1hlIBUEQNqgiUckCxBCiyIosieKv1HTsAi8lkOgGepZSep5RW3G1tLeM47urYtxGS2d31QJYBWdUgq4CsHNZPYTX1uN3vCSHGjra2akrpBUppJaW0moEs1ymltR3t7QaO465sr6+QbDzukfYyEAIhLRoUsCtEoEoSdAaWSuxSegkhZ5qbm+sppQ0HzrVTn2wymWoIIedkUVyLhiL4OWHVLBYeTscSMmkJ2aykFEQROxsbbwgh5WxPXV3d/2toNpsN5ZWVtWGfz1vIZKCquqbGgpC3XVD889CC64qYSmF6cvLDwS0bGsxmw3HjCOzt6SG3W1rYkiGwteXZ8W5ibzelpeeGMTfxCL/Gn+je78+UTacDqyurPclUmmQTCSODj7Dj7cMe3Ovs3AdVSfrN+q1YKGlKaBOiexSZlXHkVqdkOZtFKhZ7ddiHA3195J9hv9H9ri4yNDBAFpxOi8NmAz81pfLTPOwzDth5h85Pz6qu2VksOp0PIn4/ifj9xsFj4F8Fk/o4lR/VkQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/47aa2c81e19f0c82d54ce10edfd55729/8ac56/image-2.webp 240w,\n/static/47aa2c81e19f0c82d54ce10edfd55729/d3be9/image-2.webp 480w,\n/static/47aa2c81e19f0c82d54ce10edfd55729/e46b2/image-2.webp 960w,\n/static/47aa2c81e19f0c82d54ce10edfd55729/260c2/image-2.webp 1080w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/47aa2c81e19f0c82d54ce10edfd55729/8ff5a/image-2.png 240w,\n/static/47aa2c81e19f0c82d54ce10edfd55729/e85cb/image-2.png 480w,\n/static/47aa2c81e19f0c82d54ce10edfd55729/d9199/image-2.png 960w,\n/static/47aa2c81e19f0c82d54ce10edfd55729/302a4/image-2.png 1080w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/47aa2c81e19f0c82d54ce10edfd55729/d9199/image-2.png\"\n            alt=\"image 2\"\n            title=\"image 2\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span><em>국제화 라우팅 페이지 생성 과정</em></p>\n<p>첫번째 PR에서 다음 해야할 일을 다음과 같이 정리했다.</p>\n<ol>\n<li><code class=\"language-text\">ts-ignore</code> 처리 제거</li>\n<li><code class=\"language-text\">js -> ts</code> 가능한지 확인 (현재 lint 모두 무시)</li>\n<li>국제화용 <code class=\"language-text\">Link Component</code> 추가 네이밍 변경</li>\n<li><code class=\"language-text\">리다이렉트용 js 자동 생성 쉘 스크립트</code> 추가</li>\n<li><code class=\"language-text\">NEXT__DATA 기반 locale</code> 처리</li>\n</ol>\n<br />\n<br />\n<h2 id=\"2-ts-환경에-맞게-코드-변경\" style=\"position:relative;\"><a href=\"#2-ts-%ED%99%98%EA%B2%BD%EC%97%90-%EB%A7%9E%EA%B2%8C-%EC%BD%94%EB%93%9C-%EB%B3%80%EA%B2%BD\" aria-label=\"2 ts 환경에 맞게 코드 변경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. TS 환경에 맞게 코드 변경</h2>\n<p>두번째 PR에서 정상적으로 동작하는 <code class=\"language-text\">js</code> 파일을 안전하게 관리할 수 있는 <code class=\"language-text\">ts</code> 코드로 변경하는 작업을 거쳤다.</p>\n<ol>\n<li><del>ts-ignore 처리 제거</del> -> <code class=\"language-text\">완료</code></li>\n<li><del>js -> ts 가능한지 확인</del> -> <code class=\"language-text\">완료 - /lib 하위 ts 변경</code></li>\n<li><del>국제화용 Link Component 추가 네이밍 변경</del> -> <code class=\"language-text\">완료 - LocaleLink</code></li>\n<li><del>리다이렉트용 js 자동 생성 스크립트 추가</del> -> <code class=\"language-text\">완료 (/locale 하위 전부 Redirect 파일 생성)</code></li>\n<li><del>NEXT__DATA 기반 locale 처리</del> -> <code class=\"language-text\">완료</code></li>\n</ol>\n<br />\n<br />\n<h2 id=\"3-절대-경로-제거\" style=\"position:relative;\"><a href=\"#3-%EC%A0%88%EB%8C%80-%EA%B2%BD%EB%A1%9C-%EC%A0%9C%EA%B1%B0\" aria-label=\"3 절대 경로 제거 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 절대 경로 제거</h2>\n<p>라우팅 스크립트에서 편하게 설정하기 위해서 baseUrl을 설정하여 절대경로로 모듈을 import 하는 형식으로 설정했었다.</p>\n<blockquote>\n<p>as-is: import { Sample } from ‘../../components/Sample’;<br>\nto-be: import { Sample } from ‘@/components/Sample’;</p>\n</blockquote>\n<p>하지만, <strong>불행히도 모노레포에서 절대 경로를 사용하면 타입이 추론되지 않는 이슈가 있었다.. (ts 함수 한정)</strong></p>\n<p>이로 인해 절대 경로 방식을 사용하지 않고, 기존 방식인 상대 경로를 이용한 import 방식을 유지하되 Redirect 로직은 현재 디렉토리 위치를 이용하여 제거해주는 스크립트를 추가하였다.</p>\n<br />\n<br />\n<h2 id=\"4-config-타입-선언\" style=\"position:relative;\"><a href=\"#4-config-%ED%83%80%EC%9E%85-%EC%84%A0%EC%96%B8\" aria-label=\"4 config 타입 선언 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Config 타입 선언</h2>\n<p><code class=\"language-text\">next-18next.config.js</code> 모듈 설정을 불러오면서 생기는 <code class=\"language-text\">implicit any type</code> eslint 에러를 해결하기 위해 <code class=\"language-text\">next-i18next.config.d.ts</code> 타입을 선언해주었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">declare</span> <span class=\"token keyword\">module</span> <span class=\"token string\">\"next-i18next.config\"</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> i18n<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    defaultLocale<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n    locales<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 끝날 줄 알았다..</p>\n<br />\n<br />\n<h2 id=\"5-default-페이지-경로-변경\" style=\"position:relative;\"><a href=\"#5-default-%ED%8E%98%EC%9D%B4%EC%A7%80-%EA%B2%BD%EB%A1%9C-%EB%B3%80%EA%B2%BD\" aria-label=\"5 default 페이지 경로 변경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. Default 페이지 경로 변경</h2>\n<p>원래는 <code class=\"language-text\">locale prefix</code>가 붙지 않는 페이지는 Redirect 컴포넌트를 이용하여<br>\n<strong>강제로 prefix 페이지로 이동시키도록 처리</strong>하였다.</p>\n<blockquote>\n<p><a href=\"https://www.inflearn.com/signup\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.inflearn.com/signup</a> → locale 설정에 맞춰\n<a href=\"https://www.inflearn.com/ko/signup\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.inflearn.com/ko/signup</a></p>\n</blockquote>\n<p>하지만, 내부 논의 끝에 <code class=\"language-text\">locale prefix</code>가 없으면 <code class=\"language-text\">ko</code>와 동일한 페이지가 보이도록 처리하는 방향으로 수정됐다.\n<strong>이유는 기존 경로의 SEO를 유지하지 위해서였다. (너무나도 강력)</strong></p>\n<p>따라서, 리다이렉트 로직을 제거하고 무조건 ko 와 동일한 페이지가 보이도록 처리하기 위해 쉘 스크립트를 수정했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">// 수정 전 (기존 블로그 포스팅과 유사)</span>\n<span class=\"token comment\">// packages/auth/src/pages/signup/index.tsx</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Redirect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./../../lib/redirect\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Redirect<span class=\"token punctuation\">;</span>\n\n\n<span class=\"token comment\">// 수정 후</span>\n<span class=\"token comment\">// packages/auth/src/pages/[locale]/signup/index.tsx 레이아웃과 동일</span>\n<span class=\"token comment\">// packages/auth/src/pages/signup/index.tsx</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useTranslation <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"next-i18next\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> LocaleLink <span class=\"token keyword\">from</span> <span class=\"token string\">\"../../components/LocaleLink/LocaleLink\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> getStaticPaths<span class=\"token punctuation\">,</span> makeStaticProps <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"../../lib/getStatic\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> getStaticProps <span class=\"token operator\">=</span> <span class=\"token function\">makeStaticProps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"signup\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> getStaticPaths<span class=\"token punctuation\">,</span> getStaticProps <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">SignUpPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> t <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useTranslation</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"signup\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Title order<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Title<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Text size<span class=\"token operator\">=</span><span class=\"token string\">\"md\"</span> color<span class=\"token operator\">=</span><span class=\"token string\">\"gray.9\"</span> weight<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">500</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      인프런 계정으로 로그인할 수 있어요<span class=\"token punctuation\">.</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Text<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>LocaleLink href<span class=\"token operator\">=</span><span class=\"token string\">\"/signin\"</span><span class=\"token operator\">></span>Link Test<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>LocaleLink<span class=\"token operator\">></span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br />\n<br />\n<h3 id=\"6-페이지-생성-경로-변경\" style=\"position:relative;\"><a href=\"#6-%ED%8E%98%EC%9D%B4%EC%A7%80-%EC%83%9D%EC%84%B1-%EA%B2%BD%EB%A1%9C-%EB%B3%80%EA%B2%BD\" aria-label=\"6 페이지 생성 경로 변경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. 페이지 생성 경로 변경</h3>\n<p>기존 로직은 페이지 생성 시 <code class=\"language-text\">/[locale]</code> 내에서 page를 생성하도록 권장했다.</p>\n<p>하지만 redirect 방식이 변경되면서 작업에 불편함을 느낀다는 피드백을 받아,\n<code class=\"language-text\">/pages</code> 하위에 <code class=\"language-text\">router page</code>를 추가하면, <strong>빌드 시 자동으로 <code class=\"language-text\">/[locale]</code> 폴더가 generate 되도록 수정하였다.</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 760px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e8cf3198083c6391f4d91eaf2a737c1f/3c051/image-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.916666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQklEQVQoz22Py0sUARzHf6sURpeiAg/meAjqoORjC+tehwy7VP9E9jgYURAhUWEEHaXCKKKTROShsNRWXWVIV9xczXV3dh47j53HOjuz856d/cUmeOoLn9v3+4EvMBTXzBZY4Arc1ZXlNczniltRgENGuXzDUORhjqJ6+UIBEBHa29v3IAgC/puZ7z+aMjkeGFHvVrPrvrDyBcsb02iJPHpmFRW++LQhezE6ur+jo6OZIIimtra2f8JqtbqHYRhQqVR2pY3Bh09fz1r5tMMkxpCdfxPq1LbvGCZmVlPPAeDI5YGB1s7OTiIejx9o9OcSiZjnukCSJCwmk7HQ92OqLANcGRxsAYB93yYn43XPt3A3EdbCEIMADVV92BAAQPN6hoN0eg2mZ5Kgmwh+gLC0lISZnyTU6giKYgP09vQcA4AWcmG+2zVMa3szi9nNXOQYdhRaNu7I8nieoscTc8vXvRCPi6Jwiqa5a7aLrYh4kKbp0xTFXkDEQ6rmHt67/PH9u3M7suJwDIdMfr1uVdjIqqioSsqYInOMZwlR6GpVwzBuKSVm2DG5R76t3ilJ8sWywo4EtnBf1/h78HlioilFkvA7tdIlcUXXsUzcEafqufRYzVA3sKqHT2x97Vcu/RYVbgproT+kSws3/6Rev1SLsyO1EPs1fvZxdvXVqMQsPgNqaytGZ7OwncmcUHje5FkWRTYfSVwuFFka2Tz1wLHLl0KvdDfwtNuaVj5pVaQu3xbOO2apTxKVo7YhnQlsoV/XhL6/iHOt2F6o+oIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e8cf3198083c6391f4d91eaf2a737c1f/8ac56/image-3.webp 240w,\n/static/e8cf3198083c6391f4d91eaf2a737c1f/d3be9/image-3.webp 480w,\n/static/e8cf3198083c6391f4d91eaf2a737c1f/9046c/image-3.webp 760w\"\n              sizes=\"(max-width: 760px) 100vw, 760px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e8cf3198083c6391f4d91eaf2a737c1f/8ff5a/image-3.png 240w,\n/static/e8cf3198083c6391f4d91eaf2a737c1f/e85cb/image-3.png 480w,\n/static/e8cf3198083c6391f4d91eaf2a737c1f/3c051/image-3.png 760w\"\n            sizes=\"(max-width: 760px) 100vw, 760px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e8cf3198083c6391f4d91eaf2a737c1f/3c051/image-3.png\"\n            alt=\"image 3\"\n            title=\"image 3\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span><em>국제화 라우팅 페이지 생성 과정 (변경 후)</em></p>\n<br />\n<br />\n<h2 id=\"7-readme-작성\" style=\"position:relative;\"><a href=\"#7-readme-%EC%9E%91%EC%84%B1\" aria-label=\"7 readme 작성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>7. README 작성</h2>\n<p>진짜 마무리.</p>\n<p>작업 방식을 팀 내에 공유하고 이에 맞춰 <code class=\"language-text\">README</code>를 작성했다.\n또한 다국어 JSON 파일 관리를 위한 <code class=\"language-text\">컨벤션</code>에 대해서도 간략하게 정리해뒀다.</p>\n<p>즉, 현재 이 패키지 같은 경우에는 JSON 파일만 추가하면 다국어를 지원하는 상태이다.</p>\n<br />\n<br />\n<h2 id=\"8-이후-추가-작업-예정\" style=\"position:relative;\"><a href=\"#8-%EC%9D%B4%ED%9B%84-%EC%B6%94%EA%B0%80-%EC%9E%91%EC%97%85-%EC%98%88%EC%A0%95\" aria-label=\"8 이후 추가 작업 예정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>8. 이후 추가 작업 (예정)</h2>\n<h3 id=\"라이브러리화\" style=\"position:relative;\"><a href=\"#%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%ED%99%94\" aria-label=\"라이브러리화 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>라이브러리화</h3>\n<p>환경 세팅을 위한 보일러 플레이트 코드가 다수 존재한다.</p>\n<p>이를 라이브러리화해서 팀 내에서 손쉽게 사용하는 방식을 고안하고 있다.</p>\n<h3 id=\"json-검사\" style=\"position:relative;\"><a href=\"#json-%EA%B2%80%EC%82%AC\" aria-label=\"json 검사 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JSON 검사</h3>\n<p><code class=\"language-text\">locale</code> 별로 JSON에 동일한 프로퍼티가 존재하는지를 검사하는 테스트 기능을 추가하면 좋겠단 생각이 들었다.</p>\n<p>현재는 휴먼 에러로 인해 언어 변경을 놓칠 수 있는 상태이다.</p>\n<br />\n<br />\n<h2 id=\"9-참고\" style=\"position:relative;\"><a href=\"#9-%EC%B0%B8%EA%B3%A0\" aria-label=\"9 참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>9. 참고</h2>\n<ul>\n<li><a href=\"https://nextjs.org/docs/pages/building-your-application/deploying/static-exports\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Deploying: Static Exports</a></li>\n<li><a href=\"https://github.com/i18next/next-i18next?tab=readme-ov-file#static-html-export-ssg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GitHub - i18next/next-i18next: The easiest way to translate your NextJs apps.</a></li>\n<li><a href=\"https://github.com/yeonjuan/dev-blog/blob/master/JavaScript/static-html-export-i18n.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">dev-blog/JavaScript/static-html-export-i18n.md at master · yeonjuan/dev-blog</a></li>\n</ul>","fields":{"slug":"/posts/2024-05-28//posts/next-js-static-exports-with-i18n","tagSlugs":["/tag/nextjs/","/tag/static/","/tag/i18n/","/tag/tip/","/tag/effective/"]},"frontmatter":{"date":"2024-05-28","description":"Next.js 에서 정적 페이지 배포 (Static Exports)할 때 국제화 처리 하는 방법.","tags":["Next.js","Static","i18n","Tip","Effective"],"title":"Next.js를 이용한 정적 페이지 배포에 국제화 더하기","socialImage":{"publicURL":"/static/e8cf3198083c6391f4d91eaf2a737c1f/image-3.png"}}}},"pageContext":{"slug":"/posts/2024-05-28//posts/next-js-static-exports-with-i18n"}},"staticQueryHashes":["251939775","2764776372","401334301","63107425"]}